# ğŸ§ª æµ‹è¯•è‡ªåŠ¨é‡å»ºåŠŸèƒ½

## ğŸ” é—®é¢˜åˆ†æ

ä½ çš„PDFæ–‡ä»¶åœ¨ï¼š`SmartTA/src/pdf/`

ä½†æ˜¯ä» `SmartTA-Backend/` ç›®å½•å¯åŠ¨æ—¶ï¼Œæœç´¢è·¯å¾„å¯èƒ½éœ€è¦è°ƒæ•´ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd SmartTA-Backend
python test_rebuild.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. å¤‡ä»½ç°æœ‰æ•°æ®åº“
2. åˆ é™¤æ•°æ®åº“
3. è§¦å‘è‡ªåŠ¨é‡å»º
4. æµ‹è¯•æ˜¯å¦æˆåŠŸ

### æ–¹æ¡ˆ2ï¼šæ‰‹åŠ¨æµ‹è¯•

#### æ­¥éª¤1ï¼šåˆ é™¤æ•°æ®åº“

```powershell
# PowerShell
Remove-Item -Recurse -Force .\data\faiss_index

# æˆ–ä½¿ç”¨Python
# python -c "import shutil, os; shutil.rmtree('./data/faiss_index')"
```

#### æ­¥éª¤2ï¼šå¯åŠ¨æœåŠ¡

```bash
cd SmartTA-Backend
uvicorn app:app --reload
```

åº”è¯¥ä¼šçœ‹åˆ°ï¼š
```
å‘é‡æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°è¯•è‡ªåŠ¨é‡å»º...
æ­£åœ¨æœç´¢PDFæ–‡ä»¶...
åœ¨ E:\College\Project-SmartTA\SmartTA\src\pdf æ‰¾åˆ° 8 ä¸ªPDFæ–‡ä»¶
  - L1.pdf
  - L2.pdf
  ...
å¼€å§‹é‡å»ºæ•°æ®åº“...
  å¤„ç†: L1.pdf
  å¤„ç†: L2.pdf
  ...
âœ… æ•°æ®åº“é‡å»ºå®Œæˆï¼æ·»åŠ äº† 156 ä¸ªæ–‡æ¡£å—
```

---

## ğŸ› å¦‚æœè¿˜æ˜¯ä¸å·¥ä½œ

### æ£€æŸ¥1ï¼šç¡®è®¤PDFæ–‡ä»¶ä½ç½®

è¿è¡Œï¼š
```bash
python -c "import os, glob; print([f for f in glob.glob('../SmartTA/src/pdf/*.pdf')])"
```

### æ£€æŸ¥2ï¼šæ·»åŠ ç»å¯¹è·¯å¾„åˆ°æœç´¢åˆ—è¡¨

ç¼–è¾‘ `rag_engine/model_manager.py`ï¼Œåœ¨ `_find_pdf_files()` æ–¹æ³•ä¸­æ·»åŠ ï¼š

```python
pdf_dirs = [
    settings.pdf_dir,
    r"E:\College\Project-SmartTA\SmartTA\src\pdf",  # æ·»åŠ ç»å¯¹è·¯å¾„
    os.path.join(current_dir, "src", "pdf"),
    # ... å…¶ä½™è·¯å¾„
]
```

### æ£€æŸ¥3ï¼šæ‰‹åŠ¨æŒ‡å®šPDFç›®å½•

ç›´æ¥åœ¨ä»£ç ä¸­ç¡¬ç¼–ç PDFè·¯å¾„ï¼ˆç”¨äºæµ‹è¯•ï¼‰ï¼š

åœ¨ `_find_pdf_files()` ä¸­æ·»åŠ ï¼š
```python
# æµ‹è¯•ç”¨ï¼šç›´æ¥æŒ‡å®šPDFç›®å½•
test_pdf_dir = os.path.join(os.path.dirname(os.path.dirname(current_dir)), "SmartTA", "src", "pdf")
if os.path.exists(test_pdf_dir):
    pdf_files = glob.glob(os.path.join(test_pdf_dir, "*.pdf"))
    if pdf_files:
        print(f"åœ¨æµ‹è¯•è·¯å¾„ {test_pdf_dir} æ‰¾åˆ° {len(pdf_files)} ä¸ªPDFæ–‡ä»¶")
        return pdf_files
```

---

## ğŸ“ è°ƒè¯•ä¿¡æ¯

æŸ¥çœ‹æ—¥å¿—è¾“å‡ºï¼Œé‡ç‚¹å…³æ³¨ï¼š

```
æ­£åœ¨æœç´¢PDFæ–‡ä»¶...
åœ¨ [è·¯å¾„] æ‰¾åˆ° [æ•°é‡] ä¸ªPDFæ–‡ä»¶
```

å¦‚æœçœ‹åˆ°ï¼š
```
æ­£åœ¨æœç´¢PDFæ–‡ä»¶...
æœªæ‰¾åˆ°PDFæ–‡ä»¶
```

è¯´æ˜æœç´¢è·¯å¾„ä¸æ­£ç¡®ã€‚

---

## âœ… å¿«é€Ÿä¿®å¤

æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼šåœ¨ `model_manager.py` çš„ `_find_pdf_files()` ä¸­æ·»åŠ ç»å¯¹è·¯å¾„ï¼š

```python
def _find_pdf_files(self):
    """æŸ¥æ‰¾å¯ç”¨çš„PDFæ–‡ä»¶"""
    current_dir = os.getcwd()
    
    # æ·»åŠ é¡¹ç›®æ ¹ç›®å½•çš„ç»å¯¹è·¯å¾„
    project_root = os.path.abspath(os.path.join(current_dir, ".."))
    smartta_pdf_dir = os.path.join(project_root, "SmartTA", "src", "pdf")
    
    pdf_dirs = [
        smartta_pdf_dir,  # é¦–å…ˆå°è¯•é¡¹ç›®æ ¹ç›®å½•
        settings.pdf_dir,
        os.path.join(current_dir, "src", "pdf"),
        # ... å…¶ä»–è·¯å¾„
    ]
    
    # æ‰“å°è°ƒè¯•ä¿¡æ¯
    print(f"å½“å‰ç›®å½•: {current_dir}")
    print(f"é¡¹ç›®æ ¹ç›®å½•: {project_root}")
    print(f"SmartTA PDFç›®å½•: {smartta_pdf_dir}")
    print(f"ç›®å½•å­˜åœ¨: {os.path.exists(smartta_pdf_dir)}")
    
    # ... å…¶ä½™ä»£ç 
```

---

## ğŸ¯ éªŒè¯é‡å»ºæ˜¯å¦å·¥ä½œ

è¿è¡Œæµ‹è¯•åï¼Œæ£€æŸ¥ï¼š

```bash
# æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦å­˜åœ¨
ls data/faiss_index/

# æŸ¥çœ‹æ—¥å¿—
cat smartta.log | grep -i "é‡å»º"
```

å¦‚æœçœ‹åˆ° "âœ… æ•°æ®åº“é‡å»ºå®Œæˆï¼"ï¼Œè¯´æ˜æˆåŠŸäº†ï¼

